---
# Будь ласка, не редагуйте цей файл безпосередньо; він згенерований автоматично.
# Замість цього, будь ласка, відредагуйте 01-rstudio-intro.md в каталозі _episodes_rmd/
title: "Введення в R та RStudio"
teaching: 20
exercises: 5
questions:
- "Як зорієнтуватися в RStudio?"
- "Як працювати з R?"
- "Як встановити пакети?"
objectives:
- "Описати призначення та використання кожної панелі в RStudio IDE"
- "Знайти кнопки та налаштування в RStudio IDE"
- "Визначити змінну"
- "Присвоїти дані змінній"
- "Використати математичні оператори та оператори порівняння"
- "Викликати функції"
- "Керувати пакетами"
keypoints:
- "Використовуйте RStudio для написання та запуску програм на R."
- "R має звичайні арифметичні оператори."
- "Використовуйте `<-` для присвоєння значень змінним."
- "Використовуйте `install.packages()` для встановлення пакетів (бібліотек)."
source: Rmd
---




##  Мотивація

Наука - це багатоступеневий процес: як тільки ви розробили експеримент і 
зібрали дані, починаються справжні веселощі! Цей урок навчить вас, як почати
цей процес з використанням R та RStudio. Ми почнемо з необроблених даних,
проведемо дослідницький аналіз і вивчимо, як відобразити результати графічним способом. Цей приклад
починається з набору даних з [gapminder.org](https://www.gapminder.org), який містить
інформацію про населення багатьох країн в різні часи. Чи можете ви прочитати дані
в R? Чи можете ви побудувати діаграму для населення Сенегалу? Чи можете ви розрахувати середній
дохід для країн, які знаходяться в Азії? До кінця цих уроків ви 
зможете зробити такі речі, як будувати графіки населення для всіх цих країн 
менше ніж за хвилину!

## Перед початком семінару

Будь ласка, переконайтесь, що на вашому комп'ютері встановлена останні версії R та RStudio. Це важливо, оскільки деякі пакети, які використовуються у семінарі, можуть встановитись неправильно (або взагалі не встановитись), якщо R не останньої версії.

- [Завантажити та інсталювати найновішу версію R можна тут](https://www.r-project.org/)
- [Завантажити та інсталювати RStudio можна тут](https://www.rstudio.com/)

## Вступ до роботи з RStudio

Протягом цього уроку ми навчимо вас певним основам
мови програмування R, а також деяким кращим практикам організації коду для
наукових проєктів, які полегшать ваше життя.

Ми будемо використовувати RStudio: безкоштовне інтегроване середовище розробки (IDE, від англ. Integrated Development Environment) з відкритим кодом для мови R. Воно забезпечує вбудований редактор, працює на всіх платформах (у тому числі на
серверах) і забезпечує багато переваг, таких як інтеграція з управлінням версіями
і управлінням проєктами.



**Базове розташування**

Відкривши RStudio вперше, Ви побачите три панелі:

  * Інтерактивна консоль R (вся ліва частина)
  * Середовище (Environment)/Історія команд (History) (вкладки у верньому правому куті вікна)
  * Файли (Files)/Діаграми (Plots)/Пакети (Packages)/Довідка (Help)/Переглядач (Viewer) (закріплені у нижньому правому куті)

![RStudio layout]({{ site.baseurl }}/fig/01-rstudio.png)

Як тільки ви відкриєте файли, такі як скрипти R, відкриється також і панель редактора
зверху ліворуч.

![Вигляд RStudio з відкритим .R-файлом]({{ site.baseurl }}/fig/01-rstudio-script.png)


## Послідовність дій в RStudio

Існує два основних способи роботи в RStudio.

1. Перевірте та грайте в інтерактивній консолі R, потім скопіюйте код в
файл .R, щоб запустити пізніше.
   *  Це добре працює при проведенні невеликих тестів і на початковому етапі. 
   *  Це швидко стає трудомістким.
2. Почніть писати у файлі .R і використовуйте гарячі клавіші для команди "Виконати" ("Run"),
щоб перемістити поточний рядок, виділені рядки чи змінені рядки на 
інтерактивну консоль R.
   * Це хороший спосіб почати; весь ваш код зберігається пізніше.
   * Ви будете мати змогу запустити файл, створений в RStudio
   або з використанням функції `source()` мови R.

> ## Підказка: Запуск сегментів вашого коду 
>
> RStudio пропонує вам велику гнучкість у виконанні коду з вікна
> редактора. Для цього є кнопки, пункти меню та комбінації клавіш. Для запуску на виконання
> поточного рядка ви можете
>
> 1. натиснути кнопку `Run` (з англ. "Виконати") над панеллю редактора, або 
> 2. вибрати "Run Lines" (з англ. "Запустити рядки") у меню "Code" (з англ. "Код"), або 
> 3. натиснути <kbd>Ctrl</kbd>+<kbd>Enter</kbd> у Windows,
> <kbd>Ctrl</kbd>+<kbd>Return</kbd> у Linux, 
> або <kbd>&#8984;</kbd>+<kbd>Return</kbd> в OS X.
> (Це скорочення клавіш також можна побачити при наведенні
> миші на кнопку). Щоб запустити блок коду, виділіть його і натисніть `Run`.
> Якщо ви змінили рядок коду у блоці коду, який щойно було запущено,
> немає потреби повторно виділяти фрагмент і натискати `Run`, ви можете скористатися наступною
> кнопкою
> поряд, `Re-run the previous region` (з англ. "Повторно виконати попередній фрагмент"). У результаті буде виконано попередній блок коду
> включно із внесеними змінами.
{: .callout}

## Вступ до R

Більша частина вашого часу буде витрачена в інтерактивній 
консолі R. Тут ви будете запускати весь свій код, і це може бути
корисним середовищем, щоб спробувати свої ідеї, перш ніж додавати їх у файл скрипту R.
Ця консоль в RStudio така ж, як і та, яку ви отримаєте, якщо
введете `R` у своєму середовищі командного рядка.

Перше, що ви побачите в інтерактивному сеансі R, це купа
інформації, за якою слідує знак ">", і курсор, що блимає. Багато в чому
це схоже на середовище терміналу, про яке ви дізналися під час уроків
про сам термінал: воно працює за тією ж ідеєю "Цикл
Read-Evaluate-Print": ви вводите команди, R намагається їх виконати, а потім
повертає результат.

## Використання R як калькулятора

Найпростішим способом використання R є виконання арифметичних операцій:


~~~
1 + 100
~~~
{: .language-r}



~~~
[1] 101
~~~
{: .output}

І R виведе відповідь, додавши до неї "`[1]`". Не хвилюйтесь про це
зараз, ми пояснимо це пізніше. Наразі уявіть, що це вказує на вихідні дані.

Як і у випадку з терміналом bash, якщо ви введете неповну команду, R чекатиме, доки ви
завершите її:

~~~
> 1 +
~~~
{: .language-r}

~~~
+
~~~
{: .output}

Щоразу, коли ви натискаєте клавішу <kbd>Return</kbd> і сеанс R показує "`+`" замість "`>`", це
означає, що він чекає на завершення введення команди. Якщо ви хочете
скасувати команду, ви можете просто натиснути "<kbd>Esc</kbd>", і RStudio знову буде запрошувати до введення 
за допомогою запиту "`>`". 

> ## Підказка: Скасування команд
>
> Якщо ви використовуєте R з командного рядка, а не з RStudio,
> вам слід використовувати <kbd>Ctrl</kbd>+<kbd>C</kbd> замість <kbd>Esc</kbd>
щоб скасувати команду. Це стосується також і користувачів Mac!
>
> Скасування команди корисне не лише для переривання незавершених команд:
> ви також можете використовувати його для того, щоб сказати R зупинити виконання коду (наприклад, якщо він
> виконується набагато довше, ніж ви очікували), або позбутися коду, який
> ви зараз пишете.
{: .callout}

При використанні R як калькулятора порядок дій такий самий, як ви
вивчали у школі.

Від найвищого до найнижчого пріоритету:

 * Круглі дужки: `(`, `)`
 * Експоненти: `^` or `**`
 * Ділення: `/`
 * Множення: `*`
 * Додавання: `+`
 * Віднімання: `-`


~~~
3 + 5 * 2
~~~
{: .language-r}



~~~
[1] 13
~~~
{: .output}

Використовуйте круглі дужки для групування операцій, щоб примусово змінити 
порядок викоання операцій, якщо він відрізняється від порядку за замовчуванням, або для того, щоб пояснити, 
що ви маєте на меті.


~~~
(3 + 5) * 2
~~~
{: .language-r}



~~~
[1] 16
~~~
{: .output}

Це може бути громіздко, коли це не потрібно, але це прояснює ваші наміри.
Пам'ятайте, що пізніше ваш код можуть читати інші.


~~~
(3 + (5 * (2 ^ 2))) # важко читати
3 + 5 * 2 ^ 2       # здозуміло, якщо ви пам'ятаєте правила
3 + 5 * (2 ^ 2)     # якщо ви забули деякі правила, це може допомогти
~~~
{: .language-r}


Текст після кожного рядка коду називається
"коментарем". Все, що зазначено після символу хешу (або октоторпу)
`#`, R ігнорує під час виконання коду.

Дійсно малі або великі числа отримують наукові позначення:


~~~
2/10000
~~~
{: .language-r}



~~~
[1] 2e-04
~~~
{: .output}

Що є скороченням для "помножене на `10^XX`". Отже, '2e-4'
це скорочення від `2 * 10^(-4)`.

Ви також можете писати числа в наукових позначеннях:


~~~
5e3  # Зверніть увагу на відсутність мінуса
~~~
{: .language-r}



~~~
[1] 5000
~~~
{: .output}

Не турбуйтеся про те, щоб запам'ятати кожну функцію в R. Ви можете шукати їх
в Google, або, якщо ви пам'ятаєте початок назви функції, скористайтеся завершенням
табуляцією в RStudio.

Це одна з переваг RStudio над R, яка полягає у тому, що вона має автодоповнення,
що дозволяє вам легше шукати функції, їхні аргументи та
значення, які вони приймають.

Введення `?` перед назвою команди відкриє сторінку довідки для цієї
команди. Окрім докладного опису команди і того, як вона
працює, прокручування до кінця сторінки довідки зазвичай показує колекцію
прикладів коду, які ілюструють використання команди. Ми розглянемо один з прикладів
пізніше.

## Порівняння

Ми також можемо робити порівняння в R:


~~~
1 == 1  # рівність (зверніть увагу на два знаки рівності, читається як "дорівнює")
~~~
{: .language-r}



~~~
[1] TRUE
~~~
{: .output}


~~~
1 != 2  # нерівність (читається як "не дорівнює")
~~~
{: .language-r}



~~~
[1] TRUE
~~~
{: .output}


~~~
1 < 2  # менше, ніж ...
~~~
{: .language-r}



~~~
[1] TRUE
~~~
{: .output}


~~~
1 <= 1  # менше, ніж ..., або дорівнює
~~~
{: .language-r}



~~~
[1] TRUE
~~~
{: .output}


~~~
1 > 0  # більше, ніж ...
~~~
{: .language-r}



~~~
[1] TRUE
~~~
{: .output}


~~~
1 >= -9 # більше, ніж ..., або дорівнює
~~~
{: .language-r}



~~~
[1] TRUE
~~~
{: .output}

> ## Підсказка: Порівняння чисел
>
> Кілька застережень щодо порівняння чисел: вам не слід
> ніколи використовувати `==` для порівняння двох чисел, якщо вони не є
> цілими числами (тип даних, який може представляти
> лише цілі числа).
>
> Комп'ютери можуть представляти десяткові числа лише з
> певним ступенем точності, тому два числа, які виглядають
> однаково при виведенні на екран в R, насправді можуть мати
> різне представлення, а отже відрізнятися
> на невелику похибку (так звану Числовий допуск
> машини).
>
> Замість цього вам слід використовувати функцію `all.equal`.
>
> Додаткова література: [http://floating-point-gui.de/](http://floating-point-gui.de/)
{: .callout}

## Змінні та присвоєння

Ми можемо зберігати значення у змінних за допомогою оператора присвоювання `<-`, наприклад, так:


~~~
x <- 1/40
~~~
{: .language-r}

Зверніть увагу, що присвоювання не виводить значення. Натомість, ми зберегли його для подальшого
використання у місці, яке називається **змінна**. Тепер `x` містить **значення** `0.025`:


~~~
x
~~~
{: .language-r}



~~~
[1] 0.025
~~~
{: .output}

Точніше, збережене значення є *десятковим наближенням*
цього дробу, який називається [число з рухомою комою](http://en.wikipedia.org/wiki/Floating_point).

Знайдіть вкладку `Environment`(з англ. "Середовище") на одній з панелей RStudio, і ви побачите, що там з'явилась змінна `x` і її значення.
Нашу змінну `x` можна використовувати замість числа у будь-яких обчисленнях,
де очікується число:


~~~
log(x)
~~~
{: .language-r}



~~~
[1] -3.688879
~~~
{: .output}

Зверніть увагу, що змінним можна перепризначати нові значення:


~~~
x <- 100
~~~
{: .language-r}

Раніше змінна `x` містила значення 0.025, а тепер має значення 100.

Значення, що присвоюється, може містити змінну, якій це значення присвоюється:


~~~
x <- x + 1 # зверніть увагу, як RStudio оновлює опис змінної x на верхній правій вкладці
y <- x * 2
~~~
{: .language-r}

Правою частиною присвоювання може бути будь-який допустимий вираз у мові R.
Права частина *повністю обчислюється* перед присвоюванням.

> ## Завдання 1
>
> Яким буде значення кожної змінної після кожного
> виразу в наступній програмі?
>
>
> ~~~
> mass <- 47.5
> age <- 122
> mass <- mass * 2.3
> age <- age - 20
> ~~~
> {: .language-r}
>
> > ## Розв'язання до завдання 1
> >
> > 
> > ~~~
> > mass <- 47.5
> > ~~~
> > {: .language-r}
> > Це дасть значення 47.5 для змінної маси
> >
> > 
> > ~~~
> > age <- 122
> > ~~~
> > {: .language-r}
> > Це дасть значення 122 для змінної age
> >
> > 
> > ~~~
> > mass <- mass * 2.3
> > ~~~
> > {: .language-r}
> > Це помножить значення 47.5 на 2.3, щоб дати нове значення
> > 109.25 до змінної mass.
> >
> > 
> > ~~~
> > age <- age - 20
> > ~~~
> > {: .language-r}
> > Це відніме 20 від значення 122, щоб дати нове значення
> >  102 до змінної age .
> {: .solution}
{: .challenge}


> ## Завдання 2
>
> Запустіть код із попереднього завдання і напишіть команду для
> порівняння маси (mass) з віком (age). Чи маса більша за вік?
>
> > ## Розв'язання до завдання 2
> >
> > Одним із способів відповіді на це питання в R є використання `>` для запису наступного:
> > 
> > ~~~
> > mass > age
> > ~~~
> > {: .language-r}
> > 
> > 
> > 
> > ~~~
> > [1] TRUE
> > ~~~
> > {: .output}
> > Це повинно дати логічне значення TRUE, оскільки 109.25 більше ніж 102.
> {: .solution}
{: .challenge}


Назви змінних можуть містити літери, цифри, підкреслення та крапки.
Вони не можуть починатися з цифри або містити пробіли. Різні люди використовують
різні домовленості щодо довгих імен змінних, що включає

  * крапки.між.словами
  * нижні\_підкреслення_між_словами
  * верблюжийРегістрДляРозділенняСлів

Те, що ви використовуєте, залежить від вас, але **будьте послідовними**.

Для присвоювання також можна використовувати оператор `=`:


~~~
x = 1/40
~~~
{: .language-r}

Але це набагато рідше зустрічається серед користувачів R. Найважливіше - це
**бути послідовним** з оператором, який ви використовуєте. Іноді трапляються 
випадки, де використання `<-` менш заплутане, ніж `=`, і це найпоширеніший
символ, який використовується у спільноті. Тому ми рекомендуємо використовувати `<-`.

> ## Завдання 3
>
> Які з наведених нижче імен змінних R є допустимими?
> 
> ~~~
> min_height
> max.height
> _age
> .mass
> MaxLength
> min-length
> 2widths
> celsius2kelvin
> ~~~
> {: .language-r}
>
> > ## Розв'язання до завдання 3
> >
> > В якості R-змінних можна використовувати наступні:
> > 
> > ~~~
> > min_height
> > max.height
> > MaxLength
> > celsius2kelvin
> > ~~~
> > {: .language-r}
> >
> > Наступне створює приховану змінну:
> > 
> > ~~~
> > .mass
> > ~~~
> > {: .language-r}
> >
> > У цьому уроці ми не будемо обговорювати приховані змінні. Ми рекомендуємо не використовувати крапку
> > на початку назв змінних, якщо ви не плануєте робити їх прихованими.
> >
> > Для створення змінної не вдасться використати наступне:
> > 
> > ~~~
> > _age
> > min-length
> > 2widths
> > ~~~
> > {: .language-r}
> {: .solution}
{: .challenge}

